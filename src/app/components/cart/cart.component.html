<h2>Carrito de compras</h2>

<div *ngIf="items$ | async as items">
  <div *ngIf="items.length === 0">
    <p>Tu carrito está vacío.</p>
    <button mat-stroked-button (click)="agregarMasProductos()">Agregar productos</button>
  </div>

  <div *ngIf="items.length > 0">
    <table class="cart-table" style="width:100%; border-collapse: collapse;">
      <thead>
        <tr>
          <th style="text-align:left">Producto</th>
          <th>Precio</th>
          <th>Cantidad</th>
          <th>Subtotal</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of items">
          <td>{{ item.producto.nombre }}</td>
          <td>{{ item.producto.precioVenta | currency }}</td>
          <td>
            <button mat-icon-button (click)="updateQuantity(item, item.cantidad - 1)">
              <mat-icon>remove</mat-icon>
            </button>
            {{ item.cantidad }}
            <button mat-icon-button (click)="updateQuantity(item, item.cantidad + 1)">
              <mat-icon>add</mat-icon>
            </button>
          </td>
          <td>{{ (item.producto.precioVenta * item.cantidad) | currency }}</td>
          <td>
            <button mat-icon-button color="warn" (click)="removeItem(item.producto.productoId)">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <div style="margin-top: 16px; display:flex; gap:12px; align-items:center;">
      <h3>Total: {{ getTotal() | currency }}</h3>
      <span style="flex:1"></span>
      <button mat-stroked-button (click)="clearCart()">Limpiar carrito</button>
      <button mat-raised-button color="primary" (click)="irCheckout()" class="btn-continuar">
  Continuar con la compra
</button>

      <button mat-flat-button color="accent" (click)="agregarMasProductos()">Agregar productos</button>
    </div>
  </div>
</div>
