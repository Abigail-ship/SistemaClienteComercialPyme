<div class="container">
  <h2>Lista de Productos</h2>

  <div *ngIf="cargando">Cargando productos...</div>
  <div *ngIf="error" class="error">{{ error }}</div>

  <div class="search-container" *ngIf="!cargando && productos.length > 0">
    <mat-form-field appearance="outline" class="search-field">
      <mat-label>Buscar producto</mat-label>
      <input matInput [(ngModel)]="busqueda" (input)="filtrarProductos()" placeholder="Buscar..." />
      <button mat-icon-button matSuffix (click)="filtrarProductos()">
        <mat-icon>search</mat-icon>
      </button>
    </mat-form-field>
  </div>

  <div class="productos-container" *ngIf="!cargando && productosFiltrados.length > 0">
    <mat-card *ngFor="let producto of productosFiltrados" class="producto-card">
      <mat-card-title>{{ producto.nombre }}</mat-card-title>
       <!-- Imagen del producto -->
  <img *ngIf="producto.imagen"
     [src]="producto.imagen"
     alt="{{ producto.nombre }}"
     class="producto-imagen" />



      <mat-card-content>
        <p><strong>Código:</strong> {{ producto.codigo }}</p>
        <p>{{ producto.descripcion }}</p>
        <p><strong>Categoría:</strong> {{ producto.categoria?.nombre }}</p>
        <p><strong>Precio:</strong> {{ producto.precioVenta | currency }}</p>
        <p><strong>Stock:</strong> {{ producto.stock }}</p>
      </mat-card-content>
      <mat-card-actions>
        <!-- Botón +: lleva al detalle -->
        <button mat-icon-button
                aria-label="Ver detalle"
                (click)="verDetalle(producto.productoId)"
                [disabled]="producto.stock === 0">
          <mat-icon>add</mat-icon>
        </button>

        <!-- Botón Agregar directo al carrito -->
        <button mat-stroked-button
                (click)="agregarAlCarrito(producto)"
                [disabled]="producto.stock === 0">
          {{ producto.stock === 0 ? 'Agotado' : 'Agregar' }}
        </button>
      </mat-card-actions>
    </mat-card>
  </div>

  <div *ngIf="!cargando && productosFiltrados.length === 0">
    <p>No hay productos disponibles.</p>
  </div>
</div>


